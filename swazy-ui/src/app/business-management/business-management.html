<div class="min-h-screen bg-base-200">
  <div class="navbar bg-base-300 shadow-lg">
    <div class="flex-1">
      <a href="/" class="btn btn-ghost text-lg md:text-xl lg:text-2xl font-bold">{{ business()?.name }}</a>
    </div>
    <div class="flex-none flex items-center gap-4">
      <div class="text-sm md:text-base font-medium">
        {{ currentUserName() }}
      </div>
      <button class="btn btn-ghost btn-circle btn-sm md:btn-md" (click)="logout()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
        </svg>
      </button>
    </div>
  </div>

  <div class="container mx-auto p-3 md:p-6">
    <div class="tabs tabs-boxed bg-base-100 mb-4 md:mb-6 shadow-lg overflow-x-auto flex-nowrap">
      @if (permissionsService.canUpdateBusinessSettings(currentUserRole())) {
        <a
          class="tab tab-sm md:tab-md whitespace-nowrap flex-shrink-0"
          [class.tab-active]="activeTab() === 'info'"
          (click)="setActiveTab('info')">
          <span class="hidden sm:inline">📋 Üzlet adatai</span>
          <span class="sm:hidden">📋</span>
        </a>
        <a
          class="tab tab-sm md:tab-md whitespace-nowrap flex-shrink-0"
          [class.tab-active]="activeTab() === 'design'"
          (click)="setActiveTab('design')">
          <span class="hidden sm:inline">🎨 Weboldal dizájn</span>
          <span class="sm:hidden">🎨</span>
        </a>
      }
      <a
        class="tab tab-sm md:tab-md whitespace-nowrap flex-shrink-0"
        [class.tab-active]="activeTab() === 'employees'"
        (click)="setActiveTab('employees')">
        <span class="hidden sm:inline">👥 Dolgozók</span>
        <span class="sm:hidden">👥</span>
      </a>
      @if (permissionsService.canManageServices(currentUserRole())) {
        <a
          class="tab tab-sm md:tab-md whitespace-nowrap flex-shrink-0"
          [class.tab-active]="activeTab() === 'services'"
          (click)="setActiveTab('services')">
          <span class="hidden sm:inline">💼 Szolgáltatások</span>
          <span class="sm:hidden">💼</span>
        </a>
      }
      <a
        class="tab tab-sm md:tab-md whitespace-nowrap flex-shrink-0"
        [class.tab-active]="activeTab() === 'bookings'"
        (click)="setActiveTab('bookings')">
        <span class="hidden sm:inline">📅 Foglalások</span>
        <span class="sm:hidden">📅</span>
      </a>
      @if (permissionsService.canManageSchedules(currentUserRole())) {
        <a
          class="tab tab-sm md:tab-md whitespace-nowrap flex-shrink-0"
          [class.tab-active]="activeTab() === 'schedules'"
          (click)="setActiveTab('schedules')">
          <span class="hidden sm:inline">🕒 Munkaidő</span>
          <span class="sm:hidden">🕒</span>
        </a>
      }
      <a
        class="tab tab-sm md:tab-md whitespace-nowrap flex-shrink-0"
        [class.tab-active]="activeTab() === 'calendar'"
        (click)="setActiveTab('calendar')">
        <span class="hidden sm:inline">📆 Naptár</span>
        <span class="sm:hidden">📆</span>
      </a>
    </div>

    @if (activeTab() === 'info') {
      <app-business-info
        [business]="business()"
        (businessUpdated)="onBusinessUpdated($event)">
      </app-business-info>
    }

    @if (activeTab() === 'design') {
      <app-website-design
        [business]="business()"
        (businessUpdated)="onBusinessUpdated($event)">
      </app-website-design>
    }

    @if (activeTab() === 'employees') {
      <app-employee-management
        [employees]="employees()"
        [currentUserRole]="currentUserRole()"
        (employeeInvited)="onEmployeeInvited($event)"
        (invitationResent)="onInvitationResent($event)"
        (employeeRoleUpdated)="onEmployeeRoleUpdated($event)"
        (employeeRemoved)="onEmployeeRemoved($event)">
      </app-employee-management>
    }

    @if (activeTab() === 'services') {
      <app-service-management
        [services]="services()"
        [availableServices]="availableServices()"
        (serviceAdded)="onServiceAdded($event)"
        (serviceUpdated)="onServiceUpdated($event)"
        (serviceRemoved)="onServiceRemoved($event)">
      </app-service-management>
    }

    @if (activeTab() === 'bookings') {
      <app-booking-list
        [bookings]="bookings()"
        [employees]="employees()"
        (bookingCancelled)="onBookingCancelled($event)">
      </app-booking-list>
    }

    @if (activeTab() === 'schedules') {
      <app-schedule-management
        [employees]="employees()"
        [schedules]="schedules()"
        (employeeSelected)="onEmployeeSelected($event)"
        (scheduleSaved)="onScheduleSaved($event)"
        (scheduleCopied)="onScheduleCopied($event)">
      </app-schedule-management>
    }

    @if (activeTab() === 'calendar') {
      <app-booking-calendar
        [bookings]="bookings()"
        [employees]="employees()"
        [schedules]="schedules()">
      </app-booking-calendar>
    }
  </div>
</div>
